"use strict";define(["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","block_remuiblck/events"],function(t,e,n,a,i,o){function s(t){a.call(this,t),this.getFooter().find(d).length||e.exception({message:M.util.get_string("nosavebutton","block_remuiblck")})}var r=!1,d='[data-action="save"]',l='[data-action="delete"]',c='[data-action="cancel"]',g='[name="subject"]',u='[name="summary"]',v='[name="due[day]"]',f='[name="due[month]"]',m='[name="due[year]"]',h='[name="visible"]',b='[name="notify"]',p='[name="userlist[]"]';return s.TYPE="block_remuiblck-task",((s.prototype=Object.create(a.prototype)).constructor=s).prototype.registerEventListeners=function(){a.prototype.registerEventListeners.call(this);var i=this;this.getModal().on(n.events.activate,d,function(t,e){i.getModal().trigger(o.TASK_SAVE)}.bind(this)),this.getModal().on(n.events.activate,l,function(t,e){i.getModal().trigger(o.TASK_DELETE)}.bind(this)),this.getModal().on(n.events.activate,c,function(t,e){i.getModal().trigger(o.TASK_CANCEL)}.bind(this))},s.prototype.valid_settings=function(){var t;return t=""!=this.getModal().find(g).val(),this.getModal().find(g)[0].dispatchEvent(new CustomEvent("blur")),t},s.prototype.get_task_settings=function(){var t,e;return{subject:this.getModal().find(g).val(),summary:this.getModal().find(u).val(),timedue:(t=this.getModal(),e=t.find(m).val(),e+="-"+t.find(f).val(),e+="-"+t.find(v).val(),e+=" 23:59:59",new Date(e).getTime()/1e3),visible:this.getModal().find(h).is(":checked"),notify:this.getModal().find(b).is(":checked"),users:this.getModal().find(p).val()}},s.prototype.saving=function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=this.getModal().find(d);if(1==t)return e.text(M.util.get_string("saving","core_repository")).attr("disabled","disabled"),void e.attr("disabled",!0);e.attr("disabled",!1),e.text(M.util.get_string("save","core_repository")).removeAttr("disabled")},r||(i.register(s.TYPE,s,"block_remuiblck/modal_task_popup"),r=!0),s});